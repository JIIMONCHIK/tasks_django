{% extends 'main/base.html' %}
{% load static %}

{% block title %}
    {{ title }}
{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'main/css/categories_view.css' %}">
<link rel="stylesheet" href="{% static 'main/css/search.css' %}">
<script src="{% static 'main/js/categories_view.js' %}"></script>

<div class="categories-container">
    <div class="categories-header">
        <h1>–ú–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h1>
        <button class="btn btn-primary" id="btn-add-category">+ –ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</button>
    </div>

    <div class="categories-list">
        {% for category in categories %}
        <div id="category-{{ category.id }}" class="category-card {% if request.GET.highlight == category.id|stringformat:'i' %}category-highlight{% endif %}"
             style="--category-color: {{ category.color_code }};" data-category-id="{{ category.id }}">
            <div class="category-info">
                <h3>{{ category.name }}</h3>
                <div class="category-actions">
                    <button class="btn-edit-category">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="btn-delete-category">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </div>
            <div class="category-tasks-count">
                –ó–∞–¥–∞—á –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: {{ category.tasks_count }}
            </div>

            <div class="category-arrow">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 12H19M19 12L13 6M19 12L13 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        </div>
        {% empty %}
        <div class="no-categories">
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</p>
        </div>
        {% endfor %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<div class="modal" id="category-modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modal-title">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
        <form id="category-form">
            {% csrf_token %}
            <input type="hidden" id="category-id" name="category_id">

            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                <input type="text" name="name" id="category-name" class="form-control" placeholder="–†–∞–±–æ—Ç–∞, –î–æ–º, –£—á–µ–±–∞..." required>
                <div class="error-message" id="name-error"></div>
            </div>

            <div class="form-group">
                <label>–¶–≤–µ—Ç</label>
                <div class="color-picker-container">
                    <input type="color" name="color_code" id="category-color" class="form-control color-picker" value="#3a86ff">
                    <span class="color-preview" id="color-preview"></span>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" id="save-category" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}